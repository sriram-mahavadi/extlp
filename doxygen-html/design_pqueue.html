<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ExtLP: Priority Queue</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ExtLP
   &#160;<span id="projectnumber">1.0-dev</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('design_pqueue.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Priority Queue </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="author"><dt><b>Author:</b></dt><dd>Roman Dementiev (2006)</dd></dl>
<p>A priority queue is a data structure that provides a restricted subset of container functionality: it provides insertion of elements, and inspection and removal of the top element. It is guaranteed that the top element is the largest element in the priority queue, where the function object Cmp is used for comparisons. Priority queues do not allow iteration through its elements.</p>
<p>External memory priority queues are the central data structures for many I/O efficient graph algorithms ( <a class="el" href="citelist.html#CITEREF_ZehPhd">ZehPhd</a> <a class="el" href="citelist.html#CITEREF_ChiEtAl95">ChiEtAl95</a> <a class="el" href="citelist.html#CITEREF_MSS03">MSS03</a>). The main technique in these algorithms is time-forward processing ( <a class="el" href="citelist.html#CITEREF_ChiEtAl95">ChiEtAl95</a> <a class="el" href="citelist.html#CITEREF_Arg95">Arg95</a>), easily realizable by an I/O efficient priority queue. I/O efficient priority queues also find application in large-scale discrete event simulation and online sorting. The STXXL implementation of priority queues is based on <a class="el" href="citelist.html#CITEREF_San00b">San00b</a>. An operation of this priority queue, called sequence heap, takes <img class="formulaInl" alt="$ \mathcal{O}(\frac{1}{B}\log_{M/B}(I/B)) $" src="form_17.png"/> amortized I/Os, where <img class="formulaInl" alt="$ I $" src="form_18.png"/> is the total number of insertions into the priority queue. This queue needs less than a third of I/Os used by other similar cache (I/O) efficient priority queues (e.g. <a class="el" href="citelist.html#CITEREF_Brengel00">Brengel00</a> <a class="el" href="citelist.html#CITEREF_FJKT97">FJKT97</a>). The amortized run time of the STXXL priority queue are operation | internal work | I/O (amortized) --------- | --------------------------- | ------------------------ insertion | <img class="formulaInl" alt="$ \mathcal{O}(\log I) $" src="form_19.png"/> | <img class="formulaInl" alt="$ \mathcal{O}(1/B) $" src="form_20.png"/> deletion | <img class="formulaInl" alt="$ \mathcal{O}(\log I) $" src="form_19.png"/> | <img class="formulaInl" alt="$ \mathcal{O}(1/B) $" src="form_20.png"/> where <img class="formulaInl" alt="$ I $" src="form_18.png"/> is the number of performed operations.</p>
<p>A sequence heap maintains <em>R</em> <b>merge groups</b> <img class="formulaInl" alt="$ G_1,\ldots, G_R $" src="form_21.png"/> where <img class="formulaInl" alt="$ G_i $" src="form_22.png"/> holds up to <em>k</em> sorted sequences of size up to <img class="formulaInl" alt="$ m k^{i-1} $" src="form_23.png"/>, <img class="formulaInl" alt="$ m << M $" src="form_24.png"/>, see following figure. When group <img class="formulaInl" alt="$ G_i $" src="form_22.png"/> overflows, all its sequences are merged, and the resulting sequence is put into group <img class="formulaInl" alt="$ G_{i+1} $" src="form_25.png"/>. Each group is equipped with a <b>group buffer</b> of size <em>m</em> to allow batched deletion from the sequences. The smallest elements of these buffers are deleted in small batches and stored in the <b>deletion buffer</b>. The elements are first inserted into the <b>insertion priority queue</b>. On deletion, one checks the minimum elements stored in the insertion priority queue and the deletion buffer.</p>
<p>The difference of our implementation to <a class="el" href="citelist.html#CITEREF_San00b">San00b</a> is that a number of larger merge groups are explicitly kept in external memory. The sorted sequences in those groups only hold their <b>first</b> blocks in the main memory. The implementation supports parallel disks and overlaps I/O and computation. As in <a class="el" href="citelist.html#CITEREF_San00b">San00b</a>, the internal merging is based on loser trees <a class="el" href="citelist.html#CITEREF_Knu98">Knu98</a>. However, our implementation does not use <b>sentinel</b> elements.</p>
<div class="image">
<img src="san00b_pqueue_small.png" alt="san00b_pqueue_small.png"/>
<div class="caption">
The structure of STXXL priority queue</div></div>
 <h2><a class="anchor" id="design_pqueue_generator"></a>
stxxl::PRIORITY_QUEUE_GENERATOR</h2>
<p>Since the stxxl::priority_queue has many setup parameters (internal memory buffer sizes, arity of mergers, number of internal and external memory merger groups, etc.) which are difficult to guess, STXXL provides a helper meta template program that searches for the optimum settings for user demands. This is necessary to limit the amount of main memory occupied by the different buffers of the data structure. The program is called stxxl::PRIORITY_QUEUE_GENERATOR.</p>
<p>The stxxl::PRIORITY_QUEUE_GENERATOR has the following template parameters:</p>
<p>## Notes</p>
<ul>
<li>If <code>CompareType(x,y)</code> is true, then x is smaller than y. The element returned by <code>Q.top()</code> is the largest element in the priority queue. That is, it has the property that, for every other element <b>x</b> in the priority queue, <code>CompareType</code>(Q.top(),x) is false. <code>CompareType</code> must also provide <code>min_value()</code> method, that returns value of type ValueType that is smaller than any element of the queue <b>x</b>, i.e. <code>CompareType</code>(CompareType.min_value(),x) is always <b>true</b>. <br/>
 Example: comparison object for priority queue where <code>top()</code> returns the <b>smallest</b> contained integer: <div class="fragment"><pre class="fragment"><span class="keyword">struct </span>CmpIntGreater
{
    <span class="keywordtype">bool</span> operator () (<span class="keyword">const</span> <span class="keywordtype">int</span> &amp; a, <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; b)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> a &gt; b; }
    <span class="keywordtype">int</span> min_value()<span class="keyword"> const  </span>{ <span class="keywordflow">return</span> std::numeric_limits&lt;int&gt;::max(); }
};
</pre></div> Example: comparison object for priority queue where <code>top()</code> returns the <b>largest</b> contained integer: <div class="fragment"><pre class="fragment"><span class="keyword">struct </span>CmpIntLess
{
    <span class="keywordtype">bool</span> operator () (<span class="keyword">const</span> <span class="keywordtype">int</span> &amp; a, <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; b)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> a &lt; b; }
    <span class="keywordtype">int</span> min_value()<span class="keyword"> const  </span>{ <span class="keywordflow">return</span> std::numeric_limits&lt;int&gt;::min(); }
};
</pre></div> Note that <code>CompareType</code> must define strict weak ordering. (<a href="http://www.sgi.com/tech/stl/StrictWeakOrdering.html">see what it is</a>)</li>
</ul>
<ul>
<li>stxxl::PRIORITY_QUEUE_GENERATOR is template meta program that searches for <b>7</b> configuration parameters of <b>stxxl::priority_queue</b> that both minimize internal memory consumption of the priority queue to match <code>IntMemory</code> and maximize performance of priority queue operations. Actual memory consumption might be larger (use stxxl::priority_queue::mem_cons() method to track it), since the search assumes rather optimistic schedule of push'es and pop'es for the estimation of the maximum memory consumption. To keep actual memory requirements low increase the value of <code>MaxItems</code> parameter.</li>
</ul>
<ul>
<li>For functioning a priority queue object requires two pools of blocks (See constructor of stxxl::priority_queue). To construct STXXL block pools you might need <b>block_type</b> that will be used by priority queue. Note that block's size and hence it's type is generated by the stxxl::PRIORITY_QUEUE_GENERATOR in compile type from <code>IntMemory</code>, <code>MaxItems</code> and <code>sizeof(ValueType)</code> and not given directly by user as a template parameter. Block type can be extracted as stxxl::PRIORITY_QUEUE_GENERATOR&lt;&gt;::result::block_type (see <a class="el" href="tutorial_pqueue.html">STXXL Priority Queue</a>).</li>
</ul>
<ul>
<li>The configured priority queue type is available as stxxl::PRIORITY_QUEUE_GENERATOR&lt;&gt;::result.</li>
</ul>
<h2><a class="anchor" id="design_pqueue_memory"></a>
Internal Memory Consumption of stxxl::priority_queue</h2>
<p>Internal memory consumption of stxxl::priority_queue is bounded by the IntMemory template parameter in most situations. </p>
</div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="design.html">Design of STXXL</a>      </li>
      <li class="navelem"><a class="el" href="design_stl.html">The STL-User Layer</a>      </li>
      <li class="navelem"><a class="el" href="design_stl_containers.html">STXXL Containers</a>      </li>

    <li class="footer">Generated on Sat Jun 14 2014 01:55:17 for ExtLP by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
