<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ExtLP: STXXL Sorter</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ExtLP
   &#160;<span id="projectnumber">1.0-dev</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('tutorial_sorter.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">STXXL Sorter </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This section introduces into the STXXL sorter container (to learn more about the structure of stxxl::sorter, see section stxxl::sorter).</p>
<p>The STXXL sorter container combines the two functions of runs_creator and runs_merger from the stream packages into a two-phase container. As a result, the STXXL sorter implements a external memory k-way merge sort to sort large amounts of data.</p>
<p>### Create a STXXL sorter</p>
<p>Before using a STXXL sorter, we initially have to define and then to instantiate a sorter object. Two template parameters are required to define a stxxl::sorter. ValueType defines the type of the contained objects (must be a POD with no references to internal memory) and CompareType is the type of comparison object used for sorting the runs (see example below). BlockSize and AllocStr are optional (see stxxl::sorter for additional information). The more straightforward of the two sorter constructors expects the comparator object and memory_to_use (bytes) in ram for sorted runs as parameters.</p>
<div class="fragment"><pre class="fragment"><span class="comment">// template parameter &lt;ValueType, CompareType, BlockSize(optional), AllocStr(optional)&gt;</span>
<span class="keyword">typedef</span> stxxl::sorter&lt;int, my_comparator, 1*1024*1024&gt; sorter_type;

<span class="comment">// create sorter object (CompareType(), MemoryToUse)</span>
sorter_type int_sorter(my_comparator(), 64*1024*1024);
</pre></div><p>The comparator class may look as follows. The operator() is needed to compare two given elements a and b. CompareType must also provide a min_value() method, that returns the value of type ValueType that is smaller than any element of the queue x, i.e. CompareType(CompareType.min_value(),x) is always true as well as a max_value() method that works equivalent: </p>
<div class="fragment"><pre class="fragment"><span class="comment">// achieve an ascending order of sorting</span>
<span class="keyword">struct </span>my_comparator
{
  <span class="keywordtype">bool</span> operator()(<span class="keyword">const</span> <span class="keywordtype">int</span> &amp;a, <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;b)<span class="keyword"> const</span>
<span class="keyword">  </span>{
    <span class="keywordflow">return</span> a &lt; b;
  }

  <span class="keywordtype">int</span> min_value()<span class="keyword"> const </span>{
    <span class="keywordflow">return</span> std::numeric_limits&lt;int&gt;::min();
  }

  <span class="keywordtype">int</span> max_value()<span class="keyword"> const </span>{
    <span class="keywordflow">return</span> std::numeric_limits&lt;int&gt;::max();
  }
};
</pre></div><p>Note that CompareType must define strict weak ordering. <br/>
 <br/>
 The sorter container know two different kind of states - the input state and a output state. Insertion of elements are only allowed when the sorter is in the input state. After sorting is called, the container enters the output state and inserting elements is disallowed.</p>
<p>### Insert elements</p>
<p>Inserting elements is possible into the sorter container by calling the push() function: </p>
<div class="fragment"><pre class="fragment">int_sorter.push(5);
int_sorter.push(10);
int_sorter.push(3);
</pre></div><p>### Sorting all elements</p>
<p>Sorting all elements a sorter container is holding, call sort(): </p>
<div class="fragment"><pre class="fragment">int_sorter.sort();
</pre></div><p>### Access sorted elements</p>
<p>After calling sort, the items ca be read in sorted order using the operator*(), using operator++() to advance to the next item and empty() to check for the end: </p>
<div class="fragment"><pre class="fragment"><span class="keywordflow">while</span> (!int_sorter.empty())
{
  std::cout &lt;&lt; *int_sorter &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
  ++int_sorter;
}
</pre></div><p>### Determine size / Check whether the map is empty</p>
<p>To determine the size (i.e. the number of elements) of a sorter container, call size(): </p>
<div class="fragment"><pre class="fragment">std::cout &lt;&lt; <span class="stringliteral">&quot;number of elements in int_sorter: &quot;</span> &lt;&lt; int_sorter.size() &lt;&lt; std::endl;
</pre></div><p>To check if the sorter is empty, call empty() which returns true in case: </p>
<div class="fragment"><pre class="fragment">std::cout &lt;&lt; <span class="stringliteral">&quot;is int_sorter empty? &quot;</span> &lt;&lt; int_sorter.empty() &lt;&lt; std::endl;
</pre></div><p>### A minimal working example of STXXL's sorter</p>
<p>(See <a class="el" href="examples_2containers_2sorter1_8cpp-example.html">examples/containers/sorter1::cpp</a> for the sourcecode of the following example).</p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">#include &lt;stxxl/sorter&gt;</span>
<span class="preprocessor">#include &lt;stxxl/stats&gt;</span>
<span class="preprocessor">#include &lt;stxxl/timer&gt;</span>
<span class="preprocessor">#include &lt;limits&gt;</span>

<span class="keyword">struct </span>my_comparator
{
    <span class="keywordtype">bool</span> operator () (<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; a, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; b)<span class="keyword"> const</span>
<span class="keyword">    </span>{
        <span class="keywordflow">return</span> a &lt; b;
    }

    <span class="keywordtype">int</span> min_value()<span class="keyword"> const</span>
<span class="keyword">    </span>{
        <span class="keywordflow">return</span> std::numeric_limits&lt;int&gt;::min();
    }

    <span class="keywordtype">int</span> max_value()<span class="keyword"> const</span>
<span class="keyword">    </span>{
        <span class="keywordflow">return</span> std::numeric_limits&lt;int&gt;::max();
    }
};

<span class="keywordtype">int</span> <a class="code" href="extlp_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>()
{
    <span class="comment">// template parameter &lt;ValueType, CompareType, BlockSize, AllocStr(optional)&gt;</span>
    <span class="keyword">typedef</span> stxxl::sorter&lt;int, my_comparator&gt; sorter_type;

    <span class="comment">// create sorter object (CompareType(), MainMemoryLimit)</span>
    sorter_type int_sorter(my_comparator(), 64 * 1024 * 1024);

    <span class="comment">// fill sorter with elements order in descending order</span>
    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1000; i &gt; 0; i--)
    {
        int_sorter.push(i);
    }

    int_sorter.sort();  <span class="comment">// sort elements (in ascending order)</span>

    <span class="comment">// walk through sorted values and print them out</span>
    <span class="keywordflow">while</span> (!int_sorter.empty())
    {
        std::cout &lt;&lt; *int_sorter &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
        ++int_sorter;
    }

    <span class="keywordflow">return</span> 0;
}
</pre></div><p> See <a class="el" href="examples_2containers_2sorter2_8cpp-example.html">examples/containers/sorter2::cpp</a> for the sourcecode of a more comprehensive example. </p>
</div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="tutorial.html">Tutorials and Examples</a>      </li>

    <li class="footer">Generated on Sat Jun 14 2014 01:55:17 for ExtLP by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
